function initMap(){function a(a,b){function c(c,d){if(d==google.maps.StreetViewStatus.OK){var e=c.location.latLng,f=google.maps.geometry.spherical.computeHeading(e,a.position);b.setContent("<div>"+a.title+'</div><div id="pano"></div>');var g={position:e,pov:{heading:f,pitch:30}};new google.maps.StreetViewPanorama(document.getElementById("pano"),g)}else b.setContent("<div>"+a.title+"</div><div>No Street View Found</div>")}if(b.marker!=a){b.marker=a,b.setContent("<div>"+a.position+"</div>"),b.addListener("closeclick",function(){b.marker=null});var d=new google.maps.StreetViewService,e=200;d.getPanoramaByLocation(a.position,e,c),b.open(map,a)}}function b(){for(var a=new google.maps.LatLngBounds,b=0;b<markers.length;b++)markers[b].setMap(map),a.extend(markers[b].position);map.fitBounds(a)}function c(a){for(var b=0;b<a.length;b++)a[b].setMap(null)}function d(a){var b=new google.maps.MarkerImage("http://chart.googleapis.com/chart?chst=d_map_spin&chld=1.15|0|"+a+"|40|_|%E2%80%A2",new google.maps.Size(21,34),new google.maps.Point(0,0),new google.maps.Point(10,34),new google.maps.Size(21,34));return b}function e(){var a=f.getPlace();if(a.geometry)a.geometry.viewport?map.fitBounds(a.geometry.viewport):(map.setCenter(a.geometry.location),map.setZoom(17));else{var b=new google.maps.Geocoder,c=document.getElementById("neighbourhood-text").value;""==c?window.alert("You must enter an area, or address."):b.geocode({address:c},function(b,c){c==google.maps.GeocoderStatus.OK?(map.setCenter(b[0].geometry.location),map.setZoom(17)):window.alert("No details available for input: '"+a.name+"'")})}}map=new google.maps.Map(document.getElementById("map"),{center:{lat:40.7413549,lng:-73.9980244},zoom:13,styles:styles,mapTypeControl:!1});var f=new google.maps.places.Autocomplete(document.getElementById("neighbourhood-text"));f.addListener("place_changed",e);for(var g=[{title:"Park Ave Penthouse",location:{lat:40.7713024,lng:-73.9632393}},{title:"Chelsea Loft",location:{lat:40.7444883,lng:-73.9949465}},{title:"Union Square Open Floor Plan",location:{lat:40.7347062,lng:-73.9895759}},{title:"East Village Hip Studio",location:{lat:40.7281777,lng:-73.984377}},{title:"TriBeCa Artsy Bachelor Pad",location:{lat:40.7195264,lng:-74.0089934}},{title:"Chinatown Homey Space",location:{lat:40.7180628,lng:-73.9961237}}],h=new google.maps.InfoWindow,i=d("ffd105"),j=d("2ddb0f"),k=0;k<g.length;k++){var l=g[k].location,m=g[k].title,n=new google.maps.Marker({position:l,title:m,icon:i,animation:google.maps.Animation.DROP,id:k});markers.push(n),n.addListener("click",function(){a(this,h)}),google.maps.event.addListener(map,"click",function(a){h.marker=null,h.close()}),n.addListener("mouseover",function(){this.setIcon(j)}),n.addListener("mouseout",function(){this.setIcon(i)}),document.getElementById("show-listings").addEventListener("click",b),document.getElementById("hide-listings").addEventListener("click",c(markers))}}var map,markers=[],placeMarkers=[],styles=[{featureType:"administrative",elementType:"labels.text.stroke",stylers:[{color:"#ffffff"},{weight:4}]},{featureType:"administrative",elementType:"labels.text.fill",stylers:[{color:"#e85113"}]},{featureType:"transit.station",stylers:[{weight:6},{hue:"#e85113"}]},{featureType:"landscape.natural",elementType:"geometry.fill",stylers:[{visibility:"on"},{color:"#e0efef"}]},{featureType:"poi",elementType:"geometry.fill",stylers:[{visibility:"on"},{hue:"#1900ff"},{color:"#c0e8e8"}]},{featureType:"road",elementType:"geometry",stylers:[{lightness:100},{visibility:"simplified"}]},{featureType:"road",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"transit.line",elementType:"geometry",stylers:[{visibility:"on"},{lightness:700}]},{featureType:"water",elementType:"all",stylers:[{color:"#7dcdcd"}]}];