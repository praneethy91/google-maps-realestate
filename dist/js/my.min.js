function initMap(){function a(a){markers=[];for(var c=0;c<a.length;c++){var d=a[c].location,e=a[c].title,f=new google.maps.Marker({position:d,title:e,icon:j,animation:google.maps.Animation.DROP,id:c});markers.push(f),f.addListener("click",function(){b(this,i)}),f.addListener("mouseover",function(){this.setIcon(k),b(this,i)}),f.addListener("mouseout",function(){this.setIcon(j)})}}function b(a,b){function c(c,d){if(d==google.maps.StreetViewStatus.OK){var e=c.location.latLng,f=google.maps.geometry.spherical.computeHeading(e,a.position);b.setContent("<div>"+a.title+'</div><div id="pano"></div>');var g={position:e,pov:{heading:f,pitch:30}};new google.maps.StreetViewPanorama(document.getElementById("pano"),g)}else b.setContent("<div>"+a.title+"</div><div>No Street View Found</div>")}if(b.marker!=a){b.marker=a,b.setContent("<div>"+a.position+"</div>"),b.addListener("closeclick",function(){b.marker=null});var d=new google.maps.StreetViewService,e=200;d.getPanoramaByLocation(a.position,e,c),b.open(map,a)}}function c(){for(var a=new google.maps.LatLngBounds,b=0;b<markers.length;b++)markers[b].setMap(map),a.extend(markers[b].position);map.fitBounds(a)}function d(a){for(var b=0;b<a.length;b++)a[b].setMap(null)}function e(a){var b=new google.maps.MarkerImage("http://chart.googleapis.com/chart?chst=d_map_spin&chld=1.15|0|"+a+"|40|_|%E2%80%A2",new google.maps.Size(21,34),new google.maps.Point(0,0),new google.maps.Point(10,34),new google.maps.Size(21,34));return b}function f(){var a=h.getPlace();if(a.geometry)a.geometry.viewport?(map.fitBounds(a.geometry.viewport),g(a.geometry.location)):(map.setCenter(a.geometry.location),map.setZoom(17),g(a.geometry.location));else{var b=new google.maps.Geocoder,c=document.getElementById("neighbourhood-text").value;""==c?window.alert("You must enter an area, or address."):b.geocode({address:c},function(b,c){c==google.maps.GeocoderStatus.OK?(b[0].geometry.viewport?map.fitBounds(b[0].geometry.viewport):(map.setCenter(b[0].geometry.location),map.setZoom(17)),g(b[0].geometry.location)):window.alert("No details available for input: '"+a.name+"'")})}}function g(b){var d=[];return $.getJSON("https://api.foursquare.com/v2/venues/search?ll="+b.lat()+","+b.lng()+"&client_id=NEDAS2IC3HZXTZ0TZUGPPGKMYV3PZBVKS3ORT1VIX10GQRZY&client_secret=0QOLLTJMI5XODZXB5MQFCGCXJDAUXCMQSGAA4I1K0FGMEHT3&v=20170101",function(b){$.each(b.response.venues,function(a,b){d.push(new PlaceInfo(b.location.lat,b.location.lng,b.name))}),a(d),c()}),d}map=new google.maps.Map(document.getElementById("map"),{center:{lat:40.7413549,lng:-73.9980244},zoom:13,styles:styles,mapTypeControl:!1});var h=new google.maps.places.Autocomplete(document.getElementById("neighbourhood-text"));h.addListener("place_changed",f);var i=new google.maps.InfoWindow;google.maps.event.addListener(map,"click",function(a){i.marker=null,i.close()});var j=e("ffd105"),k=e("2ddb0f");document.getElementById("show-listings").addEventListener("click",c),document.getElementById("hide-listings").addEventListener("click",d(markers))}var map,markers=[],styles=[{featureType:"administrative",elementType:"labels.text.stroke",stylers:[{color:"#ffffff"},{weight:4}]},{featureType:"administrative",elementType:"labels.text.fill",stylers:[{color:"#e85113"}]},{featureType:"transit.station",stylers:[{weight:6},{hue:"#e85113"}]},{featureType:"landscape.natural",elementType:"geometry.fill",stylers:[{visibility:"on"},{color:"#e0efef"}]},{featureType:"poi",elementType:"geometry.fill",stylers:[{visibility:"on"},{hue:"#1900ff"},{color:"#c0e8e8"}]},{featureType:"road",elementType:"geometry",stylers:[{lightness:100},{visibility:"simplified"}]},{featureType:"road",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"transit.line",elementType:"geometry",stylers:[{visibility:"on"},{lightness:700}]},{featureType:"water",elementType:"all",stylers:[{color:"#7dcdcd"}]}],PlaceInfo=function(a,b,c){this.location={lat:a,lng:b},this.title=c};